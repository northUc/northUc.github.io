(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{213:function(t,s,a){"use strict";a.r(s);var e=a(0),n=Object(e.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._m(5),t._v(" "),t._m(6),t._m(7),t._v(" "),t._m(8),t._m(9),t._v(" "),t._m(10),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15),t._m(16),t._v(" "),a("p",[a("a",{attrs:{href:"https://pkg.jenkins.io/redhat-stable/",target:"_blank",rel:"noopener noreferrer"}},[t._v("下载"),a("OutboundLink")],1)]),t._v(" "),t._m(17),t._m(18),t._v(" "),t._m(19),t._m(20),t._v(" "),t._m(21),t._v(" "),a("ul",[t._m(22),t._v(" "),t._m(23),t._v(" "),a("li",[a("p",[a("code",[t._v("系统管理->Manage Roles")]),t._v(" 配置管理角色\n"),a("img",{attrs:{src:t.$withBase("/img/manageroles.jpg")}})])]),t._v(" "),a("li",[a("p",[a("code",[t._v("系统管理->Assign Roles")]),t._v(" 配置分配角色\n"),a("img",{attrs:{src:t.$withBase("/img/assignroles.jpg")}})])]),t._v(" "),t._m(24),t._v(" "),t._m(25),t._v(" "),t._m(26),t._v(" "),t._m(27),t._v(" "),t._m(28),t._v(" "),t._m(29),t._v(" "),a("li",[a("p",[t._v("只要服务器有新的分支 jenkins 就能更新到\n"),a("img",{attrs:{src:t.$withBase("/img/jenkinstasks.jpg")}}),t._v(" "),a("img",{attrs:{src:t.$withBase("/img/managecode.jpg")}}),t._v(" "),a("img",{attrs:{src:t.$withBase("/img/parameter.jpg")}})])])]),t._v(" "),t._m(30),t._v(" "),a("ul",[t._m(31),t._v(" "),a("li",[t._v("我们打开 Jenkins 首页，找到左侧的系统配置 => 插件管理 => 可选插件，搜索 Node 。选中 NodeJS 后，点击左下角的 直接安装 开始安装插件\n"),a("img",{attrs:{src:t.$withBase("/img/jenkins_node.png")}})])]),t._v(" "),a("img",{attrs:{src:t.$withBase("/img/jenkins_node1.png")}}),t._v(" "),a("ul",[t._m(32),t._v(" "),a("li",[a("p",[t._v("接着回到 Jenkins 首页，找到左侧的 "),a("code",[t._v("系统配置")]),t._v(" ，选择 "),a("code",[t._v("全局工具配置")]),t._v(" "),a("img",{attrs:{src:t.$withBase("/img/jenkins_node2.png")}})])]),t._v(" "),a("li",[a("p",[t._v("找到下面的 NodeJS ，点击 NodeJS 安装，选择相应的版本填写信息保存即可。\n"),a("img",{attrs:{src:t.$withBase("/img/jenkins_node3.png")}})])])]),t._v(" "),t._m(33),t._v(" "),a("ul",[a("li",[t._v("那我们在任务中如何使用呢？我们只需要在任务的配置中，找到构建环境，选中 Provide Node & npm bin/ folder to PATH ，选择刚才配置好的 NodeJS 即可。")]),t._v(" "),a("li",[t._v("第一次执行会下载对应的 Node 版本，后续不会下载。\n"),a("img",{attrs:{src:t.$withBase("/img/jenkins_node4.png")}})])]),t._v(" "),t._m(34),t._v(" "),t._m(35),t._v(" "),t._m(36),t._v(" "),t._m(37),t._v(" "),t._m(38),a("img",{attrs:{src:t.$withBase("/img/jenkins_node5.png")}}),t._v("\n- 一路回车即可。\n- 结束后，你会得到两个文件。分别是 xxx 和 xxx.pub。\n- 其中，xxx 是私钥文件，xxx.pub 是对应的公钥文件。我们需要在 Git 端配置公钥，在 Jenkins 端使用私钥与 Git 进行身份校验\n"),t._m(39),t._v(" "),a("ul",[a("li",[t._v("在 Gitee 中，如果你要配置公钥有2种方式：仓库公钥 和 个人公钥。其中，如果配置了仓库公钥，则该公钥只能对配置的仓库进行访问。如果配置了个人公钥，则账号下所有私有仓库都可以访问。")]),t._v(" "),a("li",[t._v("这里我们就以配置个人公钥为例子。首先打开右上角的设置 ，点击下面的 安全设置 => SSH公钥")]),t._v(" "),a("li",[t._v("在下方有个添加公钥，填入信息即可。")]),t._v(" "),a("li",[t._v("其中的标题为公钥标题，这里可以自定义标题；公钥则为刚才生成的 xxx.pub 文件。使用 cat 命令查看下文件内容，将内容填入输入框并保存。接着去 Jenkins  端配置私钥\n"),a("img",{attrs:{src:t.$withBase("/img/jenkins_node6.png")}})])]),t._v(" "),t._m(40),t._v(" "),a("ul",[a("li",[t._v("回到 Jenkins。在 Jenkins 中，私钥/密码 等认证信息都是以 凭证 的方式管理的，所以可以做到全局都通用。")]),t._v(" "),a("li",[t._v("我们可以在配置任务时，来添加一个自己的凭证。点击项目的 配置，依次找到 源码管理 => Git => Repositories\n"),a("img",{attrs:{src:t.$withBase("/img/jenkins_node7.png")}}),t._v(" "),a("img",{attrs:{src:t.$withBase("/img/jenkins_node8.png")}})]),t._v(" "),a("li",[t._v("保存后，在 Credentials 下拉列表中选择你添加的凭证。")]),t._v(" "),a("li",[t._v("如果没有出现红色无权限提示，则代表身份校验成功，可以正常访问。")])]),t._v(" "),a("img",{attrs:{src:t.$withBase("/img/jenkins_node9.png")}}),t._v(" "),t._m(41),t._v(" "),t._m(42),t._v(" "),t._m(43),t._v(" "),t._m(44),t._m(45),t._v(" "),t._m(46),t._m(47),t._v(" "),t._m(48),t._m(49),t._m(50),t._m(51),t._v(" "),t._m(52),t._v(" "),t._m(53),t._m(54)])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"jenkins"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jenkins","aria-hidden":"true"}},[this._v("#")]),this._v(" jenkins")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"git"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#git","aria-hidden":"true"}},[this._v("#")]),this._v(" git")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"搭建git服务器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#搭建git服务器","aria-hidden":"true"}},[this._v("#")]),this._v(" 搭建git服务器")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("安装git")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[this._v("yum install "),s("span",{pre:!0,attrs:{class:"token operator"}},[this._v("-")]),this._v("y git\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("创建git用户")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[this._v("useradd git\npasswd git\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("创建仓库\n"),s("ul",[s("li",[this._v("git init 会创建一个.git配置文件 提交代码用")]),this._v(" "),s("li",[this._v("git init --bare  只会创建一个仓库 让别人提交代码")])])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("su "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" git\nmkdir "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("p "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("repos"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("git\ncd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("repos"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("git\ngit "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("bare init\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"创建git客户端"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建git客户端","aria-hidden":"true"}},[this._v("#")]),this._v(" 创建git客户端")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("cd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("local"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("src\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// clone 刚才创建的 git服务器  ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// git(是用户名) @后面接服务器的地址 : 后面接git服务器的路径")]),t._v("\ngit clone git@"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".20")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".131")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("git"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("repos"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("git\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建文件 提交就可以了")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[t._v("实现SsH无密码 提交\n"),a("ul",[a("li",[t._v("需要在客户端生成一个公钥\n"),a("ul",[a("li",[t._v("生产公钥")]),t._v(" "),a("li",[t._v("ssh-keygen -t rsa")]),t._v(" "),a("li",[t._v("在"),a("code",[t._v("~/.ssh/")]),t._v(" 目录生成2个密钥 id_rsa 是私钥 id_rsa.pub 是公钥")]),t._v(" "),a("li",[t._v("copy 公钥即可")])])]),t._v(" "),a("li",[t._v("在服务端，把客户端的公钥添加到authorize_keys文件里\n"),a("ul",[a("li",[t._v("同样在服务器端生成配置文件"),a("code",[t._v("ssh-keygen -t rsa")])]),t._v(" "),a("li",[t._v("创建一个文件，定时的名字 "),a("code",[t._v("vi authorized_keys")])]),t._v(" "),a("li",[t._v("将客户端的公钥粘贴进去就可以了")])])])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"jenkins-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jenkins-2","aria-hidden":"true"}},[this._v("#")]),this._v(" Jenkins")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"安装java"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装java","aria-hidden":"true"}},[this._v("#")]),this._v(" 安装java")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("安装JDK")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-JS extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 下载包")]),t._v("\nwget http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("img"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("zhufengpeixun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cn"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("jdk1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.0")]),t._v("_211"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gz\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 解压包 x解压 z原来是一个gz的包 v显示解压的过程 f指定文件名")]),t._v("\ntar "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("xzvf jdk1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.0")]),t._v("_211"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gz \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将解压的文件 cp 走")]),t._v("\ncp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r jdk1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.0")]),t._v("_211 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("java\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// java的执行文件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("use"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("jdk1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.0")]),t._v("_211"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("java\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 执行查看版本")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("use"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("jdk1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.0")]),t._v("_211"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("java "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("version \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将java执行文件 链接到一个文件 /usr/bin/java 就指代java执行文件")]),t._v("\nln "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("s "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("use"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("jdk1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.0")]),t._v("_211"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("java "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("java\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置环境变量  java 就可以在全局访问到了")]),t._v("\nvi "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("profile\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在文件最后加入 下面的 路径根据自己的情况")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JAVA_HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("jdk1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.0")]),t._v("_211\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CLASSPATH")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JAVA_HOME")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("jre"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("lib"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("rt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JAVA_HOME")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("lib"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("dt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JAVA_HOME")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("lib"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("tools"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jar\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PATH")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("$"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PATH")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JAVA_HOME")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使刚才的配置文件生效")]),t._v("\nsource "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("profile\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这样全局就可以使用 java了")]),t._v("\njava "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("version\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"安装jenkins"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装jenkins","aria-hidden":"true"}},[this._v("#")]),this._v(" 安装jenkins")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1")]),t._v("\nsudo wget "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("O")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("yum"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("repos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("d"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("jenkins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("repo https"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("pkg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jenkins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("io"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("redhat"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("stable"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("jenkins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("repo\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2")]),t._v("\nsudo rpm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" https"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("pkg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jenkins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("io"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("redhat"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("stable"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("jenkins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("io"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("key\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3")]),t._v("\nyum install jenkins\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 卸载")]),t._v("\nservice jenkins stop\nyum clean all\nyum "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("y remove jenkins\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 启动")]),t._v("\nsystemctl start jenkins\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 重启")]),t._v("\nsystemctl restart jenkins\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 查看状态")]),t._v("\nsystemctl status jenkins\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 密码存放位子")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("lib"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("jenkins"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("secrets"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("initialAdminPassword\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 修改jenkins 默认端口")]),t._v("\nvim "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sysconfig"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("jenkins\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// 找到 JENKINS_PORT="8080" 这个就是默认的8080  将他修改即可 ')]),t._v("\n\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("关闭防火墙")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[this._v("systemctl stop firewalld"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v(".")]),this._v("service\nsystemctl disable firewalld"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v(".")]),this._v("service\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"jenkins使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jenkins使用","aria-hidden":"true"}},[this._v("#")]),this._v(" jenkins使用")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"角色和用户管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#角色和用户管理","aria-hidden":"true"}},[this._v("#")]),this._v(" 角色和用户管理")])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("p",[this._v("安装 Role-based Authorization Strategy 插件")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("p",[this._v("首先注册2个账号分别 zhangsan/lisi")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("p",[this._v("新建任务"),s("code",[this._v("dev-first&&qa-first")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("p",[this._v("新建任务 构建过程加上git，配置如下")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("p",[this._v("有几点要注意")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("p",[this._v("1、jenkins 拉去git代码 需要jenkins 获取ssh公钥,配置到git服务器中")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("p",[this._v("2、修改jenkins配置文件 将用户修改成root,"),s("code",[this._v("vim /etc/sysconfig/jenkins")]),this._v(",修改为"),s("code",[this._v('JENKINS_USER="root"')])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("p",[this._v("3、Repository URL 写git的地址")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"安装-nodejs-环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装-nodejs-环境","aria-hidden":"true"}},[this._v("#")]),this._v(" 安装 Nodejs 环境")])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[this._v("我们其实并没有在服务端安装 Node 环境。如果想要安装 Node 环境，有以下两个办法：\n"),s("ul",[s("li",[this._v("源码编译：这种方式是将 Node     源码拉下来后，在服务器端编译完成后才可以使用。时间比较长，流程也略复杂")]),this._v(" "),s("li",[this._v("使用 Jenkins Plugin 中 NodeJS 插件自动配置安装")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("p",[this._v("等待安装完毕后，返回 Jenkins 首页。找到 "),s("code",[this._v("Global Tool Configuration")]),this._v(" => "),s("code",[this._v("NodeJS")]),this._v(" => "),s("code",[this._v("新增NodeJS")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"如何使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何使用","aria-hidden":"true"}},[this._v("#")]),this._v(" 如何使用")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"使用-ssh-协议集成-git-仓库源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-ssh-协议集成-git-仓库源","aria-hidden":"true"}},[this._v("#")]),this._v(" 使用 SSH 协议集成 Git 仓库源")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("这一步，我们使用 Jenkins 集成外部 Git 仓库，实现对真实代码的拉取和构建。在这里，我们选用 Gitee  作为我们的代码源 。这里准备一个 vue-cli 项目来演示构建。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"生成公钥私钥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#生成公钥私钥","aria-hidden":"true"}},[this._v("#")]),this._v(" 生成公钥私钥")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("首先，我们先来配置公钥和私钥。这是 Jenkins 访问 Git 私有库的常用认证方式。我们可以使用 ssh-keygen 命令即可生成公钥私钥。在本地机器执行生成即可。这里的邮箱可以换成你自己的邮箱：")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[this._v("ssh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v("-")]),this._v("keygen "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v("-")]),this._v("t rsa "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v("-")]),this._v('C "xxx@qq.com"\n')])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"在-gitee-配置公钥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在-gitee-配置公钥","aria-hidden":"true"}},[this._v("#")]),this._v(" 在 Gitee 配置公钥")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"在-jenkins-配置私钥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在-jenkins-配置私钥","aria-hidden":"true"}},[this._v("#")]),this._v(" 在 Jenkins 配置私钥")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"构建镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#构建镜像","aria-hidden":"true"}},[this._v("#")]),this._v(" 构建镜像")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"编写-dockerfile"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#编写-dockerfile","aria-hidden":"true"}},[this._v("#")]),this._v(" 编写 DockerFile")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("基于 nginx:1.15 镜像做底座。")]),this._v(" "),s("li",[this._v("拷贝本地 html 文件夹内的文件，到镜像内 /etc/nginx/html 文件夹。")]),this._v(" "),s("li",[this._v("拷贝本地 conf 文件夹内的文件，到镜像内 /etc/nginx/  文件夹。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[this._v("FROM nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v(":")]),this._v("1.15"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v("-")]),this._v("alpine\nCOPY html /etc/nginx/html\nCOPY conf /etc/nginx/\nWORKDIR /etc/nginx/html\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("编写完成后，怎么生成镜像呢？我们只需要使用 docker build 命令就可以构建一个镜像了：\n"),s("ul",[s("li",[this._v("-t: 声明要打一个镜像的Tag标签，紧跟着的后面就是标签。标签格式为 镜像名:版本")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[this._v("docker build "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v("-")]),this._v("t imagename"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v(":")]),this._v("version .\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("因为我们的镜像只包含一个 nginx，所以 dockerfile 内容比较简单。我们只需要在代码根目录下新建一个名为 DockerFile 的文件，输入以下内容，并将其提交到代码库即可。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[this._v("vi DockerFile\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[this._v("FROM nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v(":")]),this._v("1.15"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v("-")]),this._v("alpine\nCOPY html /etc/nginx/html\nCOPY conf /etc/nginx/\nWORKDIR /etc/nginx/html\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[this._v("git add ./DockerFile\ngit commit "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v("-")]),this._v('m "chore'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v(":")]),this._v(' add dockerfile"\ngit push\n')])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"jenkins-端配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jenkins-端配置","aria-hidden":"true"}},[this._v("#")]),this._v(" Jenkins 端配置")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("在代码源和 DockerFile 准备就绪后，我们只需在 Jenkins 端配置下要执行的 Shell 脚本即可。找到项目的配置，依次找到 构建 => Execute shell。输入以下脚本：")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/sh -l")]),t._v("\n\nnpm install "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("registry=https"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//registry.npm.taobao.org\nnpm run build\ndocker build "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("t jenkins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("test .\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("这里脚本很简单，主要就是 安装依赖 => 构建文件 => 构建镜像。填写完毕后保存")])])}],!1,null,null,null);s.default=n.exports}}]);